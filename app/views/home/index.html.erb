<% content_for :title, "Dashboard" %>

<% if user_signed_in? %>
<div class="dashboard max-w-7xl mx-auto py-8 sm:px-6 lg:px-8">
    <h1 class="text-3xl font-bold text-center mb-8 text-gray-800 sm:text-4xl md:text-5xl lg:text-6xl">Bienvenido a Vestiventa</h1>
    <div class="stats grid grid-cols-1 gap-6 md:grid-cols-3 lg:grid-cols-4">
        <div class="bg-white shadow rounded-lg p-6 flex flex-col justify-center text-center">
            <h2 class="text-lg font-semibold text-gray-600 mb-2">Total de Prendas</h2>
            <p class="text-3xl font-bold text-indigo-600 md:text-4xl lg:text-5xl"><%= @clothing_items_count %></p>
        </div>
        <div class="bg-white shadow rounded-lg p-6 flex flex-col justify-center text-center">
            <h2 class="text-lg font-semibold text-gray-600 mb-2">Total de Ventas</h2>
            <p class="text-3xl font-bold text-indigo-600 md:text-4xl lg:text-5xl"><%= @sales_count %></p>
        </div>
        <div class="bg-white shadow rounded-lg p-6 flex flex-col justify-center text-center">
            <h2 class="text-lg font-semibold text-gray-600 mb-2">Usuarios Registrados</h2>
            <p class="text-3xl font-bold text-indigo-600 md:text-4xl lg:text-5xl"><%= @users_count %></p>
        </div>
    </div>

    <div class="quick-actions grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4">
        <a href="<%= new_clothing_item_path %>" class="btn bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2 px-4 rounded shadow transition">Agregar Prenda</a>
        <a href="<%= new_sale_path %>" class="btn bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow transition">Registrar Venta</a>
        <a href="<%= clothing_items_path %>" class="btn bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow transition">Ver Inventario</a>
        <a href="<%= sales_path %>" class="btn bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-4 rounded shadow transition">Ver Ventas</a>
    </div>

    <div class="recent-sales bg-white shadow rounded-lg p-6 mt-8">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">Ventas Recientes</h2>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead>
                    <tr>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Prenda</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Fecha</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-100">
                    <% Sale.order(created_at: :desc).limit(5).each do |sale| %>
                        <tr>
                            <td class="px-4 py-2 text-gray-700"><%= sale.id %></td>
                            <td class="px-4 py-2 text-gray-700"><%= sale.clothing_item.try(:name) %></td>
                            <td class="px-4 py-2 text-gray-700"><%= sale.created_at.strftime('%d/%m/%Y') %></td>
                        </tr>
                    <% end %>
                </tbody>
            </table>
        </div>
    </div>
</div>
<% else %>
    <div class="flex flex-col items-center justify-center h-screen mx-auto mb-8">
        <p class="text-center">Debes iniciar sesión para ver el dashboard.</p>
        <%= link_to "Iniciar Sesión", new_user_session_path, class: "btn bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow transition" %>
        <%= link_to "Registrarse", new_user_registration_path, class: "btn bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded shadow transition" %>
    </div>
<% end %>
